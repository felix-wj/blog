---
title: WSL使用记录
date: 2022-11-08 20:53:30
permalink: /pages/7ae1c9/
sidebar: auto
categories:
  - Linux
tags:
  - 
---

## 命令

[官方文档](https://learn.microsoft.com/zh-cn/windows/wsl/install)

安装默认`Linux`版本

```powershell
# 查看Linux发行版本
wsl --list --online
# 安装默认版本 Ubuntu
wsl --install
# 安装特定的 Linux 发行版
wsl --install --distribution <Distribution Name>
# 列出已安装的 Linux 发行版
wsl --list --verbose
# 将 WSL 版本设置为 1 或 2
wsl --set-version <distribution name> <versionNumber>
# 设置默认 WSL 版本
wsl --set-default-version <Version>
# 设置默认 Linux 发行版
wsl --set-default <Distribution Name>
# 更新 WSL
wsl --update
# 检查 WSL 状态
wsl --status
# 关闭
wsl --shutdown
```

## 迁移

```shell
# 先终止正在运行的wsl
wsl --shutdown
# 将需要迁移的Linux，进行导出
wsl --export Ubuntu D:/export.tar
# 导出完成之后，就需要将原有的分发进行卸载
wsl --unregister Ubuntu
# 然后将导出的文件放到需要保存的地方，进行导入即可
wsl --import Ubuntu D:\export\ D:\export.tar --version 2
```

## 配置代理

[配置 WSL2 使用 Windows 代理上网 ](https://solidspoon.xyz/2021/02/17/%E9%85%8D%E7%BD%AEWSL2%E4%BD%BF%E7%94%A8Windows%E4%BB%A3%E7%90%86%E4%B8%8A%E7%BD%91/)

```shell
export hostip=$(cat /etc/resolv.conf |grep -oP '(?<=nameserver\ ).*')
alias setss='export https_proxy="http://${hostip}:7890";export http_proxy="http://${hostip}:7890";export all_proxy="socks5://${hostip}:7890";'
alias unsetss='unset all_proxy'
```

需要代理的时候输入 `setss` 即可设置代理，取消代理就 `unsetss` ，或者新开一个窗口。

## 开启SSH

切换到`root`用户，并编辑配置文件：
```shell
vim /etc/ssh/sshd_config
```
修改以下四个位置
```
Port = 22 # 去掉前面的#号
ListenAddress 0.0.0.0		#去掉前面的#号
PasswordAuthentication yes # 将 no 改为 yes 表示使用帐号密码方式登录
PermitRootLogin yes # 允许root用户登录
```

重启`sshd`服务

```shell
dpkg-reconfigure openssh-server		#用于安装RSA_KEY
sudo service ssh restart 		#重启SSH服务
```